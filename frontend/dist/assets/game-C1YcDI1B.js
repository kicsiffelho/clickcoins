import"./clerk-UcEcY9Me.js";import{f as w,u as f}from"./clerkInit-DWrb5_7i.js";import{f as E,e as B}from"./tile-CxQaLQnt.js";async function b(e){const t=clerk.user;if(t){const n=t.id,i=await fetch("/api/store-score",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:n,score:e})});if(i.ok){const u=await i.json();console.log("Score stored:",u)}else{const u=await i.text();console.error("Error storing score:",i.status,u)}}else console.error("User not logged in")}let r=0,s=30,a,g,p,c=800,l=0,y=!1;const o=document.getElementById("game-area"),I=document.getElementById("score"),h=document.getElementById("timer"),x=document.getElementById("start-overlay"),d=document.getElementById("score-modal"),D=document.getElementById("try-again-button"),S=document.getElementById("close-modal");async function T(){const e=window.clerk.user;if(e){const t=e.id;l=await w(t),l!==null&&f(l);const n=await E(t);n?o.style.backgroundColor=n:console.log("No background color set for this user")}else console.error("User not logged in")}function v(){y=!0,r=0,s=30,c=800,k(),C(),x.style.display="none",o.style.display="block",I.style.display="block",h.style.display="block",d.style.display="none",m(),a=setInterval(m,c),g=setInterval($,1e3),p=setInterval(M,5e3)}function k(){I.textContent=`Score: ${r}`}function C(){h.textContent=`Time Left: ${s}s`}function L(){const e=Math.random()*(o.offsetWidth-60),t=Math.random()*(o.offsetHeight-60);return{x:e,y:t}}function m(){if(s<=0)return;const e=document.createElement("img");e.src=new URL("/assets/coin-Cj9i6VRi.png",import.meta.url).href,e.classList.add("coin");const{x:t,y:n}=L();e.style.left=`${t}px`,e.style.top=`${n}px`,e.addEventListener("click",()=>{o.removeChild(e),r++,k()}),o.appendChild(e),setTimeout(()=>{o.contains(e)&&o.removeChild(e)},1e3)}function $(){s<=0||(s--,C(),s<=0&&(clearInterval(a),clearInterval(g),clearInterval(p),y=!1,U()))}function M(){c>300&&(c-=100,clearInterval(a),a=setInterval(m,c))}function U(){document.getElementById("final-score").textContent=`Final score: ${r}`,d.style.display="block",y||b(r).then(()=>{const e=window.clerk.user;if(e){const t=e.id;B(t,r).then(n=>{l+=n,f(l)}).catch(n=>{console.error("Error earning currency:",n)})}else console.error("User not logged in")})}document.getElementById("start-button").onclick=function(){T(),v()};D.onclick=function(){v()};d.style.display="none";S.onclick=function(){d.style.display="none",window.location.href="main.html"};
